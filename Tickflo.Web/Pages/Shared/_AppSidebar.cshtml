@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@inject Tickflo.Core.Data.IUserRepository UserRepo
@{
    var path = ViewContext?.HttpContext?.Request?.Path.Value ?? string.Empty;
    bool IsActive(string segment) => path.Contains(segment, StringComparison.OrdinalIgnoreCase);
    var uidStr = HttpContextAccessor.HttpContext?.User?.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value;
    bool isAdmin = false;
    if (int.TryParse(uidStr, out var uid))
    {
        var meTask = UserRepo.FindByIdAsync(uid);
        meTask.Wait();
        var me = meTask.Result;
        isAdmin = me?.SystemAdmin == true;
    }
}
<aside class="block sticky top-0 h-screen w-60 shrink-0 overflow-y-auto bg-base-200 px-4 py-6" aria-labelledby="app-nav">
  <nav id="app-nav" aria-label="App navigation" class="p-2">
    <ul class="menu menu-sm w-56 rounded-box bg-base-200">
      <li><a href="/" class="@(path.Equals("/", StringComparison.OrdinalIgnoreCase) ? "menu-active" : null)" aria-current="@(path.Equals("/", StringComparison.OrdinalIgnoreCase) ? "page" : null)"><i class="fa fa-house"></i> Home</a></li>
      <li class="menu-title">General</li>
      <li>
        <a class="@(IsActive("/workspaces/") ? "menu-active" : null)" href="/workspaces" aria-current="@(IsActive("/workspaces/") ? "page" : null)"><i class="fa fa-layer-group"></i> Workspaces</a>
      </li>
      <li>
        <a class="@(IsActive("/login") ? "menu-active" : null)" href="/login" aria-current="@(IsActive("/login") ? "page" : null)"><i class="fa fa-right-to-bracket"></i> Login</a>
      </li>
      <li>
        <a class="@(IsActive("/signup") ? "menu-active" : null)" href="/signup" aria-current="@(IsActive("/signup") ? "page" : null)"><i class="fa fa-user-plus"></i> Sign Up</a>
      </li>
      @if (isAdmin) {
        <li class="menu-title">Admin</li>
        <li>
          <a class="@(IsActive("/Users/") ? "menu-active" : null)" asp-page="/Users/Index" aria-current="@(IsActive("/Users/") ? "page" : null)"><i class="fa fa-users"></i> Users</a>
        </li>
      }
    </ul>
  </nav>
</aside>
