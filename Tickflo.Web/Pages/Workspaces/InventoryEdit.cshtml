@page "/workspaces/{slug}/inventory/{id:int}/edit"
@model Tickflo.Web.Pages.Workspaces.InventoryEditModel
@{
  ViewData["Title"] = (Model.Item == null || Model.Item.Id == 0) ? "New Inventory" : "Edit Inventory";
}

<div class="flex flex-row gap-4">
  @await Html.PartialAsync("_WorkspaceSidebar", Model.WorkspaceSlug)
  <section class="p-6 flex-1">
@await Html.PartialAsync("_WorkspaceHeader", new Tickflo.Web.Pages.Shared.WorkspaceHeaderView { Slug = Model.WorkspaceSlug, Name = Model.Workspace?.Name ?? "Workspace", SectionTitle = ((Model.Item == null || Model.Item.Id == 0) ? "New Inventory" : "Edit Inventory"), AllowNewAction = Model.CanCreateInventory, NewActionLabel = "New Item", NewActionHref = $"/workspaces/{Model.WorkspaceSlug}/inventory/0/edit" })

<form method="post" class="grid gap-6">
  <div class="grid md:grid-cols-2 gap-4">
    <div class="form-control">
      <label class="label"><span class="label-text">SKU</span></label>
      <input asp-for="Item.Sku" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Location</span></label>
      <select asp-for="Item.LocationId" class="select select-bordered">
        <option value="">No location</option>
        @foreach (var loc in Model.LocationOptions)
        {
          var selectedId = Model.Item?.LocationId ?? -1;
          var isSelected = loc.Id == selectedId;
          <option selected="@isSelected" value="@loc.Id">@loc.Name</option>
        }
      </select>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Name</span></label>
      <input asp-for="Item.Name" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Description</span></label>
      <textarea asp-for="Item.Description" class="textarea textarea-bordered"></textarea>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Category</span></label>
      <input asp-for="Item.Category" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Supplier</span></label>
      <input asp-for="Item.Supplier" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Quantity</span></label>
      <input asp-for="Item.Quantity" type="number" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Minimum Stock</span></label>
      <input asp-for="Item.MinStock" type="number" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Cost</span></label>
      <input asp-for="Item.Cost" type="number" step="0.01" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Price</span></label>
      <input asp-for="Item.Price" type="number" step="0.01" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Tags</span></label>
      <input asp-for="Item.Tags" class="input input-bordered" />
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text">Status</span></label>
      <select asp-for="Item.Status" class="select select-bordered">
        <option value="active">Active</option>
        <option value="archived">Archived</option>
      </select>
    </div>
  </div>

  <div class="join md:join">
    @{ var saveLabel = (Model.Item == null || Model.Item.Id == 0) ? "Create" : "Update"; }
    <button class="btn btn-primary join-item btn-sm w-full md:w-auto" type="submit" @( (Model.Item == null || Model.Item.Id == 0 ? Model.CanCreateInventory : Model.CanEditInventory) ? "" : "disabled")>@saveLabel</button>
    <a class="btn btn-soft join-item btn-sm" href="/workspaces/@Model.Workspace?.Slug/inventory" asp-preserve-query>Cancel</a>
  </div>
  </form>
  </section>
</div>
