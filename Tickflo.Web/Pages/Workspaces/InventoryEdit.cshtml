@page "/workspaces/{slug}/inventory/{id:int}/edit"
@model Tickflo.Web.Pages.Workspaces.InventoryEditModel
@{
  ViewData["Title"] = (Model.Item == null || Model.Item.Id == 0) ? "New Inventory" : "Edit Inventory";
}

<div class="flex flex-row gap-4">
  @await Html.PartialAsync("_WorkspaceSidebar", Model.WorkspaceSlug)
  <section class="relative overflow-hidden p-6 flex-1 space-y-8 text-slate-100 rounded-3xl bg-gradient-to-br from-[#0c1220] via-[#0b101b] to-[#0a0f18]">
@await Html.PartialAsync("_WorkspaceHeader", new Tickflo.Web.Pages.Shared.WorkspaceHeaderView { Slug = Model.WorkspaceSlug, Name = Model.Workspace?.Name ?? "Workspace", SectionTitle = ((Model.Item == null || Model.Item.Id == 0) ? "New Inventory" : "Edit Inventory"), AllowNewAction = Model.CanCreateInventory, NewActionLabel = "New Item", NewActionHref = $"/workspaces/{Model.WorkspaceSlug}/inventory/0/edit" })

<div class="card bg-neutral-900/85 backdrop-blur shadow-2xl rounded-3xl text-slate-100">
  <div class="card-body">
    <h2 class="card-title">@((Model.Item == null || Model.Item.Id == 0) ? "Create New Inventory Item" : "Edit Inventory Item")</h2>
    <p class="text-sm text-base-content/70">@((Model.Item == null || Model.Item.Id == 0) ? "Add a new item to your inventory with details like SKU, quantity, and pricing." : "Update the details for this inventory item.")</p>
  </div>
</div>

<div class="card bg-base-100 shadow-sm rounded-3xl">
  <div class="card-body">
    <form method="post" class="grid gap-6">
      <div class="grid md:grid-cols-2 gap-4">
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">SKU</span></label>
      <input asp-for="Item.Sku" class="input input-bordered bg-neutral-900/80" placeholder="e.g., SKU-001" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Sku"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Location</span></label>
      <select asp-for="Item.LocationId" class="select select-bordered bg-neutral-900/80">
        <option value="">No location</option>
        @foreach (var loc in Model.LocationOptions)
        {
          var selectedId = Model.Item?.LocationId ?? -1;
          var isSelected = loc.Id == selectedId;
          <option selected="@isSelected" value="@loc.Id">@loc.Name</option>
        }
      </select>
      <span class="text-error text-sm mt-1" asp-validation-for="Item.LocationId"></span>
    </div>
    <div class="form-control md:col-span-2">
      <label class="label"><span class="label-text font-semibold text-slate-200">Name</span></label>
      <input asp-for="Item.Name" class="input input-bordered bg-neutral-900/80" placeholder="Item name" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Name"></span>
    </div>
    <div class="form-control md:col-span-2">
      <label class="label"><span class="label-text font-semibold text-slate-200">Description</span></label>
      <textarea asp-for="Item.Description" class="textarea textarea-bordered bg-neutral-900/80" rows="3" placeholder="Detailed description"></textarea>
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Description"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Category</span></label>
      <input asp-for="Item.Category" class="input input-bordered bg-neutral-900/80" placeholder="e.g., Hardware, Software" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Category"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Supplier</span></label>
      <input asp-for="Item.Supplier" class="input input-bordered bg-neutral-900/80" placeholder="Supplier name" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Supplier"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Quantity</span></label>
      <input asp-for="Item.Quantity" type="number" class="input input-bordered bg-neutral-900/80" min="0" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Quantity"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Minimum Stock</span></label>
      <input asp-for="Item.MinStock" type="number" class="input input-bordered bg-neutral-900/80" min="0" placeholder="Alert threshold" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.MinStock"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Cost</span></label>
      <div class="join w-full">
        <span class="btn btn-ghost join-item pointer-events-none">$</span>
        <input asp-for="Item.Cost" type="number" step="0.01" class="input input-bordered join-item flex-1 bg-neutral-900/80" min="0" placeholder="0.00" />
      </div>
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Cost"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Price</span></label>
      <div class="join w-full">
        <span class="btn btn-ghost join-item pointer-events-none">$</span>
        <input asp-for="Item.Price" type="number" step="0.01" class="input input-bordered join-item flex-1 bg-neutral-900/80" min="0" placeholder="0.00" />
      </div>
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Price"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Tags</span></label>
      <input asp-for="Item.Tags" class="input input-bordered bg-neutral-900/80" placeholder="comma, separated, tags" />
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Tags"></span>
    </div>
    <div class="form-control">
      <label class="label"><span class="label-text font-semibold text-slate-200">Status</span></label>
      <select asp-for="Item.Status" class="select select-bordered bg-neutral-900/80">
        <option value="active">Active</option>
        <option value="archived">Archived</option>
      </select>
      <span class="text-error text-sm mt-1" asp-validation-for="Item.Status"></span>
    </div>
  </div>

      <div class="flex flex-col sm:flex-row gap-2 pt-4 border-t border-white/10">
        @{ var saveLabel = (Model.Item == null || Model.Item.Id == 0) ? "Create Item" : "Update Item"; }
        <button class="btn btn-primary w-full sm:w-auto" type="submit" @( (Model.Item == null || Model.Item.Id == 0 ? Model.CanCreateInventory : Model.CanEditInventory) ? "" : "disabled")>
          <i class="fa fa-save mr-2"></i>@saveLabel
        </button>
        <a class="btn btn-ghost w-full sm:w-auto" href="/workspaces/@Model.Workspace?.Slug/inventory" asp-preserve-query>
          <i class="fa fa-times mr-2"></i>Cancel
        </a>
      </div>
      <div class="text-error text-sm" asp-validation-summary="ModelOnly"></div>
    </form>
  </div>
</div>
  </section>
</div>
